using System;

namespace SentenceRBX
{
    public static class ScriptHubHtmlGenerator
    {
        public static string GenerateHtml()
        {
            return @"<!DOCTYPE html>
<html lang=""en"">
<head>
    <meta charset=""UTF-8"">
    <meta name=""viewport"" content=""width=device-width, initial-scale=1.0"">
    <title>Script Hub</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        html,body{width:100%;height:100%;background:#0f0f0f;color:#E8E8E8;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;overflow:hidden}
        
        body::before{content:'';position:fixed;top:0;left:0;width:100%;height:100%;background:radial-gradient(circle at 20% 50%,rgba(90,159,232,0.04),transparent 50%),radial-gradient(circle at 80% 20%,rgba(90,159,232,0.02),transparent 50%);pointer-events:none;z-index:0}
        
        #content{width:100%;height:100%;overflow-y:auto;overflow-x:hidden;position:relative;z-index:1}
        #content::-webkit-scrollbar{width:8px}
        #content::-webkit-scrollbar-track{background:#111111}
        #content::-webkit-scrollbar-thumb{background:linear-gradient(180deg,#5A9FE8,#4A8FD8);border-radius:4px}
        #content::-webkit-scrollbar-thumb:hover{background:linear-gradient(180deg,#6AAFFF,#5A9FE8)}
        
        .scripts-container{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:14px;padding:18px;animation:fadeIn .4s ease-in-out;max-width:1800px;margin:0 auto}
        
        @keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
        @keyframes slideUp{from{opacity:0;transform:translateY(30px) scale(0.96)}to{opacity:1;transform:translateY(0) scale(1)}}
        @keyframes shine{0%{left:-100%;top:-100%}100%{left:200%;top:200%}}
        @keyframes spin{to{transform:rotate(360deg)}}
        @keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}
        @keyframes glow{0%,100%{box-shadow:0 0 15px rgba(90,159,232,0.15)}50%{box-shadow:0 0 25px rgba(90,159,232,0.3)}}
        
        .script-card{background:linear-gradient(145deg,#1a1a1a,#161616);border:1px solid #252525;border-radius:10px;overflow:hidden;display:flex;flex-direction:column;transition:all .35s cubic-bezier(.4,0,.2,1);cursor:pointer;min-height:280px;animation:slideUp .5s ease-out forwards;opacity:0;position:relative;box-shadow:0 2px 12px rgba(0,0,0,.4),inset 0 1px 0 rgba(255,255,255,.02)}
        
        .script-card::before{content:'';position:absolute;inset:0;border-radius:10px;padding:1px;background:linear-gradient(135deg,rgba(90,159,232,.3),transparent 40%,transparent 60%,rgba(90,159,232,.2));-webkit-mask:linear-gradient(#fff 0 0) content-box,linear-gradient(#fff 0 0);-webkit-mask-composite:xor;mask-composite:exclude;opacity:0;transition:opacity .35s ease;pointer-events:none}
        
        .script-card::after{content:'';position:absolute;width:150%;height:150%;background:linear-gradient(135deg,transparent 40%,rgba(255,255,255,0.04) 50%,transparent 60%);top:-75%;left:-75%;transition:all .6s ease;pointer-events:none;z-index:1}
        
        .script-card:hover{transform:translateY(-6px) scale(1.015);border-color:rgba(90,159,232,.5);box-shadow:0 12px 28px rgba(90,159,232,.25),0 0 30px rgba(90,159,232,.1),inset 0 1px 0 rgba(255,255,255,.05);background:linear-gradient(145deg,#1f1f1f,#1a1a1a)}
        .script-card:hover::before{opacity:1}
        .script-card:hover::after{animation:shine 1.2s ease-in-out}
        .script-card:nth-child(n+1):nth-child(-n+15){animation-delay:calc(var(--i) * .04s)}
        
        .script-image{width:100%;height:100px;background:linear-gradient(135deg,#141414,#1a1a1a 50%,#141414);display:flex;align-items:center;justify-content:center;font-size:40px;position:relative;overflow:hidden;flex-shrink:0}
        
        .script-image::before{content:'';position:absolute;inset:0;background:linear-gradient(180deg,transparent 0%,rgba(15,15,15,0.4) 100%);pointer-events:none;z-index:1}
        
        .script-image img{width:100%;height:100%;object-fit:cover;transition:transform .6s cubic-bezier(.34,1.56,.64,1),filter .4s ease;filter:brightness(0.8) contrast(1.1)}
        .script-card:hover .script-image img{transform:scale(1.1);filter:brightness(0.95) contrast(1.2)}
        
        .script-image::after{content:'';position:absolute;inset:0;background:linear-gradient(180deg,transparent 50%,rgba(0,0,0,.6));pointer-events:none;z-index:2}
        
        .script-category{position:absolute;top:8px;right:8px;padding:4px 9px;border-radius:6px;font-size:8px;font-weight:700;color:#fff;z-index:10;box-shadow:0 2px 8px rgba(0,0,0,.5);text-transform:uppercase;letter-spacing:.5px;backdrop-filter:blur(10px);transition:all .25s ease}
        .script-card:hover .script-category{transform:scale(1.03);box-shadow:0 3px 10px rgba(0,0,0,.6)}
        
        .cat-universal{background:linear-gradient(135deg,rgba(90,159,232,.94),rgba(74,143,216,.94));border:1px solid rgba(90,159,232,.35)}
        .cat-hub{background:linear-gradient(135deg,rgba(33,150,243,.94),rgba(25,118,210,.94));border:1px solid rgba(33,150,243,.35)}
        .cat-premium{background:linear-gradient(135deg,rgba(255,152,0,.94),rgba(245,124,0,.94));border:1px solid rgba(255,152,0,.35)}
        .cat-game{background:linear-gradient(135deg,rgba(76,175,80,.94),rgba(56,142,60,.94));border:1px solid rgba(76,175,80,.35)}
        
        .script-content{display:flex;flex-direction:column;flex:1;padding:11px;gap:5px;background:linear-gradient(180deg,rgba(18,18,18,0.5),rgba(15,15,15,.7));position:relative;z-index:2}
        
        .script-title{font-size:12.5px;font-weight:700;line-height:1.3;color:#E8E8E8;margin-bottom:2px;text-shadow:0 1px 3px rgba(0,0,0,.3);letter-spacing:.2px;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;transition:color .3s ease;min-height:32px}
        .script-card:hover .script-title{color:#5A9FE8}
        
        .script-game{font-size:9px;color:#5A9FE8;font-weight:600;margin-bottom:4px;text-transform:uppercase;letter-spacing:.3px;display:flex;align-items:center;gap:4px;transition:color .3s ease;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
        .script-game::before{content:'üéÆ';font-size:10px}
        .script-card:hover .script-game{color:#6AAFFF}
        
        .script-description{flex:1;font-size:10px;color:#A8A8A8;line-height:1.5;overflow:hidden;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;word-break:break-word;margin-bottom:6px;min-height:30px;transition:color .3s ease}
        .script-card:hover .script-description{color:#C8C8C8}
        
        .script-author{font-size:9px;color:#757575;padding:6px 0;border-top:1px solid rgba(90,159,232,.15);border-bottom:1px solid rgba(90,159,232,.15);display:flex;align-items:center;gap:4px;transition:all .3s ease;margin-bottom:3px}
        .script-author::before{content:'üë§';font-size:9px;opacity:.7}
        .script-card:hover .script-author{color:#909090;border-top-color:rgba(90,159,232,.25);border-bottom-color:rgba(90,159,232,.25)}
        
        .script-stats{display:flex;gap:10px;padding:7px 0 8px 0;font-size:9px;color:#757575;font-weight:600;justify-content:flex-start;flex-wrap:wrap}
        .script-stats span{display:flex;align-items:center;gap:3px;transition:all .3s ease;padding:3px 6px;border-radius:5px;background:rgba(90,159,232,.06)}
        .script-card:hover .script-stats span{color:#A8A8A8;background:rgba(90,159,232,.12);transform:translateY(-1px)}
        
        .script-footer{display:flex;gap:6px;padding-top:6px;margin-top:auto}
        
        .btn{flex:1;padding:8px 11px;border:none;border-radius:6px;font-size:9px;font-weight:700;cursor:pointer;transition:all .3s cubic-bezier(.4,0,.2,1);font-family:inherit;text-transform:uppercase;letter-spacing:.5px;position:relative;overflow:hidden;box-shadow:0 2px 6px rgba(0,0,0,.3)}
        
        .btn::before{content:'';position:absolute;top:50%;left:50%;width:0;height:0;border-radius:50%;background:rgba(255,255,255,.12);transform:translate(-50%,-50%);transition:width .4s,height .4s;z-index:0}
        .btn:hover::before{width:200px;height:200px}
        
        .btn span{position:relative;z-index:1}
        
        .btn-execute{background:linear-gradient(135deg,#5A9FE8,#4A8FD8);color:#fff;box-shadow:0 2px 8px rgba(90,159,232,.35)}
        .btn-execute:hover{background:linear-gradient(135deg,#6AAFFF,#5A9FE8);box-shadow:0 4px 14px rgba(90,159,232,.5);transform:translateY(-2px)}
        .btn-execute:active{transform:translateY(0);box-shadow:0 2px 6px rgba(90,159,232,.3)}
        
        .btn-copy{background:linear-gradient(135deg,#1f1f1f,#1a1a1a);color:#C8C8C8;border:1px solid #2d2d2d;box-shadow:0 2px 6px rgba(0,0,0,.3)}
        .btn-copy:hover{background:linear-gradient(135deg,#252525,#1f1f1f);color:#E8E8E8;border-color:#383838;box-shadow:0 4px 12px rgba(0,0,0,.4);transform:translateY(-2px)}
        .btn-copy:active{transform:translateY(0);box-shadow:0 2px 6px rgba(0,0,0,.3)}
        
        .btn-loading{pointer-events:none;opacity:.6}
        .btn-loading::after{content:'';position:absolute;top:50%;left:50%;width:14px;height:14px;margin:-7px 0 0 -7px;border:2px solid rgba(255,255,255,.25);border-top-color:#fff;border-radius:50%;animation:spin .7s linear infinite;z-index:2}
        
        .loading{display:flex;align-items:center;justify-content:center;min-height:100vh;flex-direction:column;gap:22px;background:#0f0f0f}
        .spinner{width:70px;height:70px;border:4px solid rgba(90,159,232,.12);border-top:4px solid #5A9FE8;border-radius:50%;animation:spin 1s cubic-bezier(.68,-.55,.265,1.55) infinite;box-shadow:0 0 35px rgba(90,159,232,.35)}
        .loading-text{color:#5A9FE8;font-size:13px;font-weight:700;letter-spacing:1.5px;animation:pulse 1.4s ease-in-out infinite;text-transform:uppercase}
        
        .empty{display:flex;align-items:center;justify-content:center;min-height:100vh;color:#757575;text-align:center;background:#0f0f0f;flex-direction:column;gap:18px;padding:20px}
        .empty-icon{font-size:64px;opacity:.4;margin-bottom:10px;filter:drop-shadow(0 4px 10px rgba(0,0,0,.3))}
        .empty-text{font-size:17px;font-weight:700;margin-bottom:7px;color:#909090;letter-spacing:.5px}
        .empty-subtext{font-size:12px;color:#757575;max-width:400px;line-height:1.6}
        
        .error{color:#ff6b6b;border:1px solid rgba(255,107,107,.3);border-radius:10px;padding:18px;margin:18px;background:rgba(255,107,107,.05);backdrop-filter:blur(8px)}
        .error-title{font-weight:700;margin-bottom:9px;font-size:14px}
        
        @media (max-width:1200px){.scripts-container{grid-template-columns:repeat(auto-fill,minmax(185px,1fr))}}
        @media (max-width:768px){.scripts-container{grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:12px;padding:12px}.script-card{min-height:260px}.script-image{height:85px}.btn{font-size:8px;padding:7px 9px}.script-stats{gap:8px}}
    </style>
</head>
<body>
    <div id=""content""></div>
    <script>
        window.debugScriptHub={lastData:null,lastError:null,version:'1.6',initialized:false};
        const scriptHub={
            log(m,d){console.log(`[${new Date().toLocaleTimeString()}] [ScriptHub] ${m}`,d||'')},
            error(m,e){console.error(`[${new Date().toLocaleTimeString()}] [ScriptHub] ERROR: ${m}`,e||'');window.debugScriptHub.lastError={message:m,error:e}},
            warn(m,d){console.warn(`[${new Date().toLocaleTimeString()}] [ScriptHub] WARNING: ${m}`,d||'')},
            
            execute(id,title){
                this.log('Execute requested',{scriptId:id,title});
                if(!id||!title)return this.error('Execute: Missing scriptId or title',{scriptId:id,title});
                
                if(window.chrome?.webview){
                    try{
                        const msg=JSON.stringify({type:'execute',data:{scriptId:id,title}});
                        this.log('Sending message to C#',msg);
                        window.chrome.webview.postMessage(msg);
                        this.log('Execute message sent successfully');
                    }catch(ex){this.error('Failed to send execute message',ex)}
                }else this.error('WebView2 communication not available');
            },
            
            copy(btn,id,title){
                this.log('Copy requested',{scriptId:id,title});
                if(!id||!title)return this.error('Copy: Missing scriptId or title',{scriptId:id,title});
                
                const originalText=btn.textContent;
                btn.textContent='Loading...';
                btn.classList.add('btn-loading');
                
                if(window.chrome?.webview){
                    try{
                        const msg=JSON.stringify({type:'copy',data:{scriptId:id,title}});
                        this.log('Sending message to C#',msg);
                        window.chrome.webview.postMessage(msg);
                        this.log('Copy message sent successfully');
                        
                        setTimeout(()=>{
                            btn.textContent=originalText;
                            btn.classList.remove('btn-loading');
                        },1800);
                    }catch(ex){
                        this.error('Failed to send copy message',ex);
                        btn.textContent=originalText;
                        btn.classList.remove('btn-loading');
                    }
                }else{
                    this.error('WebView2 communication not available');
                    btn.textContent=originalText;
                    btn.classList.remove('btn-loading');
                }
            },
            
            renderScripts(scripts){
                this.log('renderScripts called',{count:scripts?.length||0});
                window.debugScriptHub.lastData=scripts;
                const content=document.getElementById('content');
                if(!content)return this.error('Content container not found');
                if(!scripts||!Array.isArray(scripts)){
                    this.warn('Invalid scripts data type',{received:typeof scripts,isArray:Array.isArray(scripts)});
                    return this.showEmpty('Invalid data received','The script list data is not valid.');
                }
                if(scripts.length===0){
                    this.log('Empty scripts list');
                    return this.showEmpty('No scripts found','Try adjusting your filters or search query.');
                }
                try{
                    content.innerHTML=this.buildScriptsHTML(scripts);
                    this.log(`Successfully rendered ${scripts.length} scripts`);
                    this.attachCardAnimations();
                }catch(renderError){
                    this.error('Error during HTML rendering',renderError);
                    this.showError(`Rendering failed: ${renderError.message}`);
                }
            },
            
            buildScriptsHTML(scripts){
                return '<div class=""scripts-container"">'+scripts.map((s,i)=>{
                    try{
                        if(!s.id||!s.title){
                            this.warn(`Script ${i} has missing id or title`,s);
                            return '';
                        }
                        const catClass=this.getCategoryClass(s.categoryId);
                        const eTitle=this.escape(s.title);
                        const eDesc=this.escape(s.description||'');
                        const eAuthor=this.escape(s.author||'Unknown');
                        const eGame=this.escape(s.gameTitle||'Universal');
                        const eId=this.escape(s.id);
                        return`<div class=""script-card"" style=""--i:${i}""><div class=""script-image"">${s.imageUrl?`<img src=""${this.escape(s.imageUrl)}"" alt=""${eTitle}"" onerror=""this.style.display='none'"">`:''}<div class=""script-category cat-${catClass}"">${this.escape(s.category||'Game')}</div></div><div class=""script-content""><div class=""script-title"" title=""${eTitle}"">${eTitle}</div><div class=""script-game"">${eGame}</div><div class=""script-description"" title=""${eDesc}"">${eDesc}</div><div class=""script-author"">by ${eAuthor}</div><div class=""script-stats""><span>üëÅÔ∏è ${s.views||0}</span><span>‚ù§Ô∏è ${s.likes||0}</span>${s.keySystem?'<span>üîí Key</span>':''}</div><div class=""script-footer""><button class=""btn btn-execute"" data-script-id=""${eId}"" data-script-title=""${eTitle}"" data-action=""execute"">Execute</button><button class=""btn btn-copy"" data-script-id=""${eId}"" data-script-title=""${eTitle}"" data-action=""copy"">Load Script</button></div></div></div>`;
                    }catch(err){
                        this.error(`Error building card ${i}`,err);
                        return '';
                    }
                }).join('')+'</div>';
            },
            
            attachCardAnimations(){
                const cards=document.querySelectorAll('.script-card');
                this.log(`Attached animations to ${cards.length} cards`);
                const buttons=document.querySelectorAll('.btn[data-action]');
                this.log(`Found ${buttons.length} buttons with data-action`);
                buttons.forEach((btn,i)=>{
                    this.log(`Attaching listener to button ${i}`,{
                        action:btn.getAttribute('data-action'),
                        scriptId:btn.getAttribute('data-script-id'),
                        scriptTitle:btn.getAttribute('data-script-title')
                    });
                    btn.addEventListener('click',function(e){
                        e.preventDefault();
                        const action=this.getAttribute('data-action');
                        const scriptId=this.getAttribute('data-script-id');
                        const scriptTitle=this.getAttribute('data-script-title');
                        scriptHub.log('üî¥ BUTTON CLICKED!',{action,scriptId,scriptTitle});
                        if(action==='execute')scriptHub.execute(scriptId,scriptTitle);
                        else if(action==='copy')scriptHub.copy(this,scriptId,scriptTitle);
                    });
                });
            },
            
            getCategoryClass(catId){
                const map={universal:'universal',hub:'hub',premium:'premium',game:'game'};
                return map[catId]||'game';
            },
            
            showLoading(){
                this.log('Showing loading indicator');
                const content=document.getElementById('content');
                if(content)content.innerHTML='<div class=""loading""><div class=""spinner""></div><div class=""loading-text"">Loading scripts...</div></div>';
            },
            
            showEmpty(title,subtitle){
                this.log(`Showing empty state: ${title}`);
                const content=document.getElementById('content');
                if(content)content.innerHTML=`<div class=""empty""><div class=""empty-icon"">üìú</div><div class=""empty-text"">${this.escape(title)}</div><div class=""empty-subtext"">${this.escape(subtitle)}</div></div>`;
            },
            
            showError(msg){
                this.error(`Showing error: ${msg}`);
                const content=document.getElementById('content');
                if(content)content.innerHTML=`<div class=""empty""><div class=""empty-icon"">‚ö†Ô∏è</div><div class=""error""><div class=""error-title"">Error</div><div>${this.escape(msg)}</div></div></div>`;
            },
            
            escape(text){
                if(!text)return '';
                const div=document.createElement('div');
                div.textContent=String(text);
                return div.innerHTML;
            }
        };
        
        window.scriptHub=scriptHub;
        window.debugScriptHub.initialized=true;
        scriptHub.log('Script Hub initialized successfully',{version:window.debugScriptHub.version});
        
        window.addEventListener('message',event=>{
            try{
                scriptHub.log('Message received from host',event.data);
                const msg=event.data;
                if(!msg||typeof msg!=='object'){
                    scriptHub.warn('Invalid message format',msg);
                    return;
                }
                const{type,data}=msg;
                switch(type){
                    case 'renderScripts':scriptHub.renderScripts(data);break;
                    case 'showLoading':scriptHub.showLoading();break;
                    case 'showError':scriptHub.showError(data?.message||'Unknown error');break;
                    case 'showEmpty':scriptHub.showEmpty(data?.title||'No scripts',data?.subtitle||'');break;
                    default:scriptHub.warn(`Unknown message type: ${type}`);
                }
            }catch(error){
                scriptHub.error('Error processing message',error);
            }
        });
        
        scriptHub.log('Event listeners registered',{hasWebView:!!(window.chrome&&window.chrome.webview)});
    </script>
</body>
</html>";
        }
    }
}
